# 統計・検定手法に悩んだ時のガイド
また統計や検定に馴染みがない人はこちらが役立ちます。[→統計・検定技術の基礎知識](https://ai-trend.jp/basic-study/#estimator)

## きっかけ
研究などで有意性を示すときにt検定をすることはよくよくあると思うのですが、なかなかそんな単純な2群の比較ばかりとは限りません。そこで大学の時の担当教員に[『すぐわかる統計処理の選び方』](https://ci.nii.ac.jp/ncid/BB03230711)がとてもわかりやすいという話を聞き、購入しました。

たしかに難解な数学的処理についてページを割くことなく「こういう状況にはこれ！」というようなカタログ的な書籍の作り方をしているので、いつも作業の横においておきたいなと思い、このページでまとめることにしました。なお、項目のまとめ方は個人的により分かりやすく全く書き換えています。

## データの下ごしらえ段階
まずデータを集めた場合には必ずこのステップは機械的・反射的に必ず処理します。

なぜならかき集めたデータはほとんどの場合標本の性質であり、知りたいのは母集団の性質であるからです。ここでやるべきことは

* ヒストグラムによるデータの分布の把握*▶データのばらつき具合の把握*
* 基礎統計量（最小・最大・平均・標準偏差・分散）の計算*▶データの特徴の把握*

です。これにより「このくらいの値が一般的（＝はずれ値ではない）んだなあ」などといった感覚的な部分を読み取ります。「感覚的」というとずいぶん曖昧なものだなあと思うかもしれませんが、まずは*見えていないものを自分の想像力の及ぶ範囲まど引っ張ってこないと次の対策が立ちません*。一方上記の手法でデータの特徴を読み取れればむしろラッキーで、世の中には被験者数の少ない実験や何度も起きないレアな現象ではヒストグラムにしてもデータの全体像がみえないことも多々あります。そのときに使うのが**母平均の区間推定・検定**で、データの姿がよくある形（**すなわち、正規分布**）であることなどを仮定してとりあえず次のステップに進むことにします。

## 「差」があるかどうかを調べる場合
「AとBには差がある」（＝データの平均のブレではなく、明確に違いがあると述べたい）というときに使います。


### 2つのデータ群がある場合
このあたりが統計の教科書で真っ先に出てくるt検定などの話のレベルです。一番シンプルな2群の比較です。2群の比較はつまり「**AとBに差はあるのか**」を示すときに使いますが、あまりにもベーシックすぎてなんでもこれで検定すればいいのではと誤解される方も多いです。実際には2群の検定で最も重要なのは**その2群はt検定がふさわしい**のか判別することです。計算はPCがやってくれますし。

データの全体像がわからない or 等分散性が保証できない2群はそもそも**ウェルチの検定**、同じ被験者の１回目のデータと２回目のデータの比較では2群に関連性があるので**対応のある場合の検定**を行う必要があります。

またそもそも、正規性が不安（中心極限定理を使えない等）ときにはそもそもt検定など行えませんからその他の**ウィルコクスンの順位和検定**や**コルモゴロフ・スミルノフの検定**を利用することになります。

### ３つ以上のデータ群がある場合
3つ以上となると「差があるか」を調べるだけでも群間の比較がが大変になります。

具体的には下のような分析手法にトライすることになりますが、そもそも多重比較の数的処理の方法にも何種類かあり、計算のしくみ上回避できない誤差があります。一般的に群の数が多ければ多いほど判定が甘くなる事が多いので慎重に行います。

* 分散分析*▶そもそもすべての群の平均の差はそもそも「ブレ」として許容できるのではないか*
* 多重比較*▶サンプリングによる「ブレ」でないとすると、どの群とどの群で差があるか*
* 繰り返しの測定など対応のあるデータ*▶フリードマンの検定*

まだ２つの比較同様、正規性に不安があればクラスカルウォリスの検定などを利用し、順位に置き換えることで**情報量を少し犠牲にして検定**します。

## 「因子」に基づく原因を探る場合
この場合はそもそもデータ自体が多変数（たとえば体重と身長の組み合わせのように１つのデータが複数からなる）の場合に利用する方法。

### 因子と因子の関係性を明らかにする
これまでは単変数の比較、つまりはマクロなデータのみかたをしていました。つまり被験者の体重、体脂肪、身長などの複数の項目の中から一つを取り出してグループ同士で比較していましたが、今度はそれらをもっとデータ自身の内側、「そもそも体重なんて身長と関連があるのだから。。」といったデータ自身を構成する因子について分析します。

* 共分散と相関係数の算出*▶因子同士の関係性の強さの把握*
* 単回帰分析*▶因子同士の関係性の数式化*
* 主成分分析*▶複数の因子を１つの因子に置き換える*

特に変数が増えて３変数以上になると、単回帰分析は重回帰分析になり、主成分分析も同様に３変数以上で行える。回帰分析は**ある項目は他の項目で推測できる**分析に対して、主成分分析はそのデータの性質を明快に示す指標を得るために**複数の項目を１つにまとめた新たな説明変数を生み出す**分析手法であり、まったくことなるので注意。逆にデータ自体によりわかりやすく説明できる潜在的な因子を探るのは*因子分析*である。

### 因子を活用した推測・判別
説明の都合上、前節で単回帰分析を登場させています（実際に因子同士の関係性をみるのに回帰直線は便利）が、多くの研究の場合回帰する目的は**値の推測**のはずです。また因子はなにかの「原因」担っていることが多いですから総合的に見て「この因子とこの因子がこのくらいになると発生する」といった**判別分析**といった、これもまた推測に用いる手法となります。

* 2項ロジスティック回帰分析*▶二項分布を仮定してTRUE/FALSEの確率を予測*
* プロビット分析*▶正規分布を仮定して因子が変動した時のTRUE/FALSEの確率を予測*

どちらも判別分析の手法ですが、仮定している分布が異なる点に注意して下さい。プロビット分析は特に正規分布に基づいて限界効果が算出できる点で重宝されます。

なお、ロジスティック分析はロジスティック関数を利用するところに由来していますが、ロジスティック関数を利用するのは解析に便利（微積分が容易）な形をしているからです。このため関数の形を元に分類して*曲線回帰*と呼ぶこともあります。


### 【8】x系列だけのデータ
* 判別分析
* 2項ロジスティック回帰分析
* プロビット回帰分析
* 共分散分析
* 2元配置の分散分析（繰返しあり）
* 

### 【9】x系列だけのデータ
* 判別分析
* 共分散分析
* 多項ロジスティック回帰分析
* 多変量分散分析
*
*

### 【10】x系列だけのデータ
* 母比率の区間推定
* 母比率の検定

### 【11】x系列だけのデータ
* 2つの母平均の区間推定
* 2つの母比率の差の検定
* 独立性の検定
* オッズ比
* 対数線型分析
* マンテル・ヘンツェル分析

### 【12】x系列だけのデータ
* 適合度検定


### 【13】
* 同等性の検定
* 独立性の検定
* リジット分析
*

## 【14】実験回数をへらすため因子を複数操作したデータ分析（繰返しなし）
* 同等性の検定
* 独立性の検定
* 2元配置の分散分析（繰返しなし）
* 反復測定による1元配置の分散分析
* フリードマンの検定
* 多次元尺度法
* コレスポンデンス分析

### 【15】実験回数をへらすため因子を複数操作したデータ分析（繰返しあり）
* 2元配置の分散分析（繰返しあり）
* 下位検定
* 線形混合モデル

### 【16】時系列のレコードを持つテーブル
* 移動平均
* 指数平滑化
* 自己相関係数
* 交差相関係数
* 自己回帰モデル
* ARMAモデル
* ARIMAモデル
* 時系列のデータ回帰分析
* カプランマイヤー法
* コックス回帰分析
* パネル分析

### 【17】対象者別のレコードを持つテーブル
* 相関分析
* 相関係数の検定
* 相関係数の差の検定
* クロス集計表
* 独立性の検定
* 比率の区間推定
* 比率の差の検定
* コレスポンデンス分析
* 多重応答分析
* コンジョイント分析

## 最後に
とはいえ。
* 判別分析
* クラスター分析
